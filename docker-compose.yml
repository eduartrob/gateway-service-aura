version: '3.8'

services:
  api-gateway:
    build: . # Construye la imagen usando el Dockerfile en el directorio actual
    container_name: api-gateway
    environment:
      - PORT=5000 # Puerto en el que corre la aplicación dentro del contenedor
      # URLs de los microservicios. Debes apuntar a los nombres de servicio en Docker Compose.
      - AUTH_URL=http://auth-service:3001
      - CHAT_URL=http://chat-service:3002
      - POSTS_URL=http://posts-service:3003
      - NOTIFICATIONS_URL=http://notifications-service:3004
    ports:
      - "5000:5000" # Mapea el puerto 5000 del host al 5000 del contenedor
    volumes:
      # Opcional: Monta el código fuente para desarrollo con recarga en caliente (hot-reloading)
      # Para producción, es mejor no usar volumes y confiar en la imagen construida.
      - .:/usr/src/app
      - /usr/src/app/node_modules # Evita que la carpeta local de node_modules sobreescriba la del contenedor

# Aquí deberías añadir las definiciones de tus otros servicios
# (auth-service, chat-service, etc.) para que el gateway pueda comunicarse con ellos.
